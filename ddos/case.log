control mode ntp cache test(delete cache until recieve response which more field is 0)  



1.enable ntp sequence Mismatch check
2.Client send a ntp control mode request packet.
python3 send_scapy.py "IP()/UDP(sport = 10000, dport = 123)/NTPControl(op_code = 1, count = 8, data=b'\x00' * 8)"
3.ddos forward packet,execute vppshow ddos ntp-cache detail in ddos,create a ntp cache.(count = 8, more = 1, offset = 0)



4.server send ntp control mode response packet which ntp field is (count = 8, more 1 ,offset 0)
python3 send_scapy.py --direction outbound "IP()/UDP(dport = 10000, sport = 123)/NTPControl(response=1, status_word=NTPSystemStatusPacket(), op_code = 1, count = 8, data= b'\x00' * 8, more = 1, offset = 0)"
5.ddos forward packet,the ntp cache is not deleted.



6.server send ntp control mode response packet which ntp field is (count = 8, more 1 ,offset 8)
python3 send_scapy.py --direction outbound "IP()/UDP(dport = 10000, sport = 123)/NTPControl(response=1, status_word=NTPSystemStatusPacket(), op_code = 1, count = 8, data= b'\x00' * 8, more = 1, offset = 16)"
7.ddos forward packet,the ntp cache is not deleted.


8.server send ntp control mode response packet which ntp field is (count = 8, more 1 ,offset 16)
python3 send_scapy.py --direction outbound "IP()/UDP(dport = 10000, sport = 123)/NTPControl(response=1, status_word=NTPSystemStatusPacket(), op_code = 1, count = 8, data= b'\x00' * 8, more = 1, offset = 8)"
9.ddos forward packet,the ntp cache is not deleted.


10.server send ntp control mode response packet which ntp field is (count = 8, more 0 ,offset 24)
python3 send_scapy.py --direction outbound "IP()/UDP(dport = 10000, sport = 123)/NTPControl(response=1, status_word=NTPSystemStatusPacket(), op_code = 1, count = 8, data= b'\x00' * 8, more = 0, offset = 24)"
11.ddos forward packet,the ntp cache is deleted.









